\documentclass[]{article}

%opening
\title{Cryptography Exercises}
\author{Pol Pujol Santaella}
\usepackage{amsmath}
\usepackage{graphicx}
\numberwithin{figure}{section}
\usepackage{algorithm}
\usepackage{algorithmic}


\begin{document}

\maketitle
\newpage
\tableofcontents

\newpage
\section{Introduction to Cryptography}
\bigskip
\textbf{1. What is the number of possible keys in the mono-alphabetic substitution cipher?} 

\medskip
\noindent 
In a mono-alphabetic substitution cipher, each letter of the plain text is replaced by a unique letter of the ciphertext alphabet. Assuming standard English alphabet of 26 letters (A-Z), each key is a \textit{permutation} of the alphabet. The number of possible permutations of 26 letters is $26!$
\begin{center}
\textbf{Number of possible keys} $= \mathbf{26! \approx 4.03 \times 10^{26}}$
\end{center}
\bigskip
\noindent \textbf{2. Decrypt the following ciphertext using the shift cipher (key is 4). \\ 
\begin{center}
	IPPMTXMG GYVZI
\end{center} }

\medskip

\noindent 
First of all we have to map letters to numbers $A = 0, B = 1,..., Z=25$ 
\medskip
\begin{center}
	\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
		\hline
		I & P & M & T & X & G & Y & V & Z \\
		\hline
		8 & 15 & 12 & 19 & 23 & 6 & 24 & 21 & 25 \\
		\hline
	\end{tabular}
\end{center}
To decrypt that message using a shift cipher with a key of 4, we have to know the strategy of cipher decryption:
\begin{center}
	$P_i = (C_i - k) \bmod 26$
\end{center}
Where $P_i$ is the plaintext letter, $C_i$ is the ciphertext letter, and \textit{k} is the shift key.
\medskip
\begin{center}
I: $P_0 = (8 - 4) \bmod 26 = 4 = E$ \\
P: $P_1 = (15 - 4) \bmod 26 = 11 = L$ \\
...

\textbf{The decrypted message is: ELLIPTIC CURVE}
\end{center}
\newpage
\noindent
\textbf{3. The following ciphertext has been encrypted using shift cipher.}
\begin{center}
	FTUE EOTQYQ UE ZAF EQOGDQ
\end{center}
\indent
Figure 1.1. shows the frequency distribution of the letter in the English alphabet. Use this table to guess which is the encryption key, and decrypt the message.
\begin{figure}[h]
	\centering
	\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|}
		\hline
		a & b & c & d & e & f & g & h & i & j & k & l & m \\
		\hline
		8.05 & 1.62 & 3.2 & 3.65 & 12.31 & 2.28 & 1.61 & 5.14 & 7.18 & 0.1 & 0.52 & 4.03 & 2.25 \\
		\hline
	\end{tabular}
	\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|}
		\hline
		n & o & p & q & r & s & t & u & v & w & x & y & z \\
		\hline
		7.19 & 7.94 & 2.29 & 0.20 & 6.03 & 6.59 & 9.59 & 3.1 & 0.93 & 2.03 & 0.2 & 1.88 & 0.09 \\
		\hline
	\end{tabular}
	\caption{Frequency distribution of English letters}
\end{figure}

\medskip

\noindent
To decrypt a shift cipher ciphertext using English letter frequencies to guess the key, we have to know de Shift cipher formula:\\
\begin{center}
	$C = (P + k) \bmod 26, P = (C - k) \bmod 26$
\end{center}
The strategy is to count letter frequency in the ciphertext, compare the most frequent ciphertext letter to the most frequent letter in English and estimate the shift key:\\
\begin{center}
	$k = (C_{\text{freq}} - P_{\text{freq}}) \bmod 26$
\end{center}
Then we can decrypt using this key and verify readability of the resulting plaintext; adjust key if necessary. \\

1. Count letters of ciphertext:
\begin{center}
	\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|}
		\hline
		E & Q & F & T & U & O & Z & A & Y & G & D \\
		\hline
		4 & 4 & 2 & 2 & 2 & 2 & 1 & 1 & 1 & 1 & 1 \\
		\hline
	\end{tabular}
\end{center}


2. Try mapping most frequent ciphertext letter Q with plaintext E:
\begin{center}
	$Q = 16, E = 4$ \\
	$k = (16 - 4) \bmod 26 = 12$
\end{center}

3. Decrypt ciphertext with the key.
\begin{center}
	$F = 5, (5 - 12) \bmod 26 = 19 = T$ \\
	$T = 19, (19 - 12) \bmod 26 = 7 = H$ \\
	...
\end{center}

4. You will obtain the plaintext: 
\begin{center}
	\textbf{THIS SCHEME IS NOT SECURE}
\end{center}
\newpage

\noindent \textbf{4. How would you define "perfect secrecy" in a formal way? (Discussed in Unit 3).} \\
\textit{Perfect Secrecy} is a fundamental concept in information theoretic cryptography. \\
Let:
\begin{itemize}
	\item M be the random variable representing plaintext message
	\item C be the random variable respresenting the ciphertext.
	\item K be the random variable representing the key.
\end{itemize} 
Perfect Screcy is when we observe that ciphertext C = c gives no information about the plaintext M.\\
So formally a system that achieves perfect secrecy is:
\begin{center}
	$P(M | C) = P(M)$
\end{center}
For example: The One-Time Pad satisfies this condition when the key K is uniformly random, used only once, and as long as the message.

\bigskip 
\noindent
\textbf{5. In the slide "two notions of security", we talk about two equivalent ways to prove the security of the scheme. Explain why the two wats are equivalent, i.e., what is the logic law we are using.} \\ \\
The logic law we are using here is the \textit{contrapositive} law, which says that the 2 statements \textit{"If A then B" and "If not B then not A"} are equivalent.

\bigskip

\noindent \textbf{6. How would you define "computational security" in a formal way? (Discussed in Unit 3.)} \\ \\
We define a cryptosystem as computationally secure if no probabilistic polynomial-time (PPT) adversary can gain a non-negligible advantatge in breaking it.

\newpage
\bigskip
\noindent
\textbf{7. It is thought that cryptography was present in Islamic culture since, at least, the start of the Abbasid caliphate (VII century). It is known that, at that time, Al-Khalil ibn Ahmad al-Farahidi wrote a book called "Kitab al-Muamma" (Book of Cryptographic Messages), which is considered to be lost. Later, in the IX century, Al-Kindi described a way to break subsitution ciphers, which were popular at that time. He described the frequency attack discussed in Unit 1 as follows. Finde more details in Sin99.} 

\medskip

\noindent
\textit{One way to solve an encrypted message, if we know its language, is to find a different plaintext of the same language long enough to fill one sheet or so, and then we count the occurrences of each letter. We call the most frequently occurring letter the "first", the next most occurring letter the "second", the following most occurring letter the "third", and so on, until we account for all the different letters in the plaintext sample. Then we look at the cipher text we want to solve and we also classify its symbols. We finde the most occurring symbol and change it to the form of the "first" letter of the plaintext sample, the next most common symbol is changed to the form of the "second" letter, and the following most common symbol is changed to the form of the "third" letter, and so on, until we account for all symbols of the cryptogram we want to solve.} 

\medskip \noindent
\textbf{This method does not always work, because the frequency of letters in the text cannot be exactly the same as the one of the language. Give an algorithm that, following the spirit of this attack, generates the text that are more likely to be the plaintext.}

\medskip \noindent
We have to design an algorithm that, given a substitution-cipher text and a language model (frequencies), produces candidate plaintexts ranked by likelihood -- following Al-Kindi's idea but using statistical scoring and heuristic search. \\

\noindent \textbf{We Assume:} 
\begin{itemize}
	\item English Alphabet, 26 uppercase letters.
	\item We have a reference language model (letter frequency)
	\item Ciphertext is long. Short texts make stats noisy.
\end{itemize} 
\textbf{Strategy:}
\begin{enumerate}
	\item Create an initial key by rank-matching letter frequencies (Al-Kindi style)
	\item Define a scoring function that measures how "English-like" a candidate plaintext is -- e.g. sum of log n-gram probabilities plus a word-match bonus.
	\item Use a heuristic search (hill-climbing with random restarts or simulated annealing / genetic algorithm) to explore permutations by swapping letter mapping to maximize the score.
	\item Output top-K candidate plaintexts and check with dictionary/word matches for verification.
\end{enumerate}
\begin{algorithm}
	\caption{}
	\begin{algorithmic}
		\STATE \textbf{Input:} C: ciphertext, r: restarts, iters: iterations
		\STATE \textbf{Output:} Plaintext with max score.
		\STATE Initialize $bestPlain \gets inf$
		\STATE Initialize $bestScore \gets inf$
		\FOR{$i = 1$ to range($r$)}
			\IF{$r == 0$}
				\STATE $key$ = initialKeyFreq($C$)
			\ELSE 
				\STATE $key$ = randomKey() 
			\ENDIF
			\STATE $currentPlain$ = Decrypt(C, key)
			\STATE $currentScore$ = scoreFunction($currentPlain$)
			\STATE $improved$ = True  
			\STATE $it = 0$
			\WHILE{$it < iters$ and $improved$}
				\STATE $improved$ = False 
				\STATE $it += 1$
				\FOR {? in range(200):}
					\STATE $a, b$ = randomSample(alphabet, 2)
					\STATE $key2$ = key.Copy()
					\STATE Tranpose(a, b, key2) // Transpose 2 selected letters of key2
					\STATE $plain2$ = Decrypt(C, key2)
					\STATE $score2$ = scoreFunction(plain2)
					\IF{$score2$ > $currentScore$}
						\STATE $key$ = $key2$
						\STATE $currentPlain$ = $plain2$
						\STATE $currentScore$ = $score2$
						\STATE $improved$ = True
						break
					\ENDIF
				\ENDFOR
			\ENDWHILE
			\IF{$currentScore$ > $bestScore$}
				\STATE $bestScore$ = $currentScore$
				\STATE $bestPlain$ = $currentPlain$
			\ENDIF
		\ENDFOR
		\RETURN $bestPlain$, $bestScore$
	\end{algorithmic}
\end{algorithm}

\newpage
\textbf{9. The development of cryptoanalysis tecchniques that study the frequency of letters motivated more involved cryptosystems that can be considered variants of the substitution sipher. This is the case of the scheme}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.7\textwidth]{figureEx9.png}
	\caption{Photo of Risala fi Istikhraj al-Kutub al-Muâ€™ammah (On Extracting Obscured Correspondence) by Al-Kindi, from Wikipedia}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.7\textwidth]{figure9_2.png}
	\caption{ Document from https://www.ugr.es/~aquiran/cripto/museo/gce01.htm}
\end{figure}

\noindent \textbf{used by Diego Sarmiento de AcuÃ±a, Conde de Gondomar and Felipe III, king of Spain, Portugal and other regions, at the beginning of the XVII century. Diego Sarmiento de AcuÃ±a was a kind of Spanish ambassador in London, and he needed to send (and receive) confidential messages to the king. They used the following tricks to reduce the effect of frequency analysis, which are described in the picture presented below.}
\begin{enumerate}
	\item \textbf{Each letter had two possible symbols, while vowels had four.}
	\item \textbf{Some frequent pairs of letter had specific symbols}
	\item \textbf{Some signs were used to modify the decrypted message. In particular, there was a sign to indicate that part of the text was dummy.}
\end{enumerate}
\textbf{The following questions are about ciphers with the properties described above.
}
\begin{enumerate}
	\item \textbf{Compute the number of possible keys for the substitution ciphers satisfying (1).}
	\item \textbf{Discuss the use of subtitution ciphers satisfying (1) and (2) with respect ciphers satisfying only (1).}
	\item \textbf{Discuss the utility of (3), in addition to (1) and (2).}
	\item \textbf{Suggest situation in which the use of signs like the ones in (4) can make statistical attacks harder.}
\end{enumerate}

Given a historical scheme with these properties (applied to the 26-letter English alphabet):

\begin{enumerate}
	\item Each consonant has 2 possible cipher symbols, each vowel has 4 possible cipher symbols
	\item some frequent letter-pairs (digraphs) are represented by single special symbols
	\item special signs can modify the interpretation of subsequent text (e.g., mark a segment as dummy / null)
\end{enumerate}

\noindent 
1) Number of possible keys (case (1) only)\\
There are 26 distinct plaintext letters. Assume vowels = 5 (A, E, I, O, U) and consonants = 21. The scheme assigns to each consonant exactly 2 distinc cipher symbols, and to each vowel exactly 4 distinct cipher symbols. \\

\begin{center}
	$S = 21 \times 2 + 5 \times 4 = 42 + 20 = 62$
\end{center}







\newpage
\section{Mathematical Background}
\textbf{1. Computation of probabilities. \\ \\
	\indent A) Coun tossing: Associate Heads to 0, and Tails to 1. Compute the probability that the output is '1' when tossing a coin. Compute the probability that the output is '101' after tossing the coin three times. \\ \\
	\indent B) Dice rolling: Compute the probability that the output is '2', and the probability that the output is 'even'.}
	






















\end{document}
